(function($){var lastTime=0;window._requestAnimationFrame=function(callback,element){var currTime=new Date().getTime();var timeToCall=Math.max(0,80-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall);},timeToCall);lastTime=currTime+timeToCall;return id;};window._cancelAnimationFrame=function(id){clearTimeout(id);};var Lib=window.Lib||{};Lib.carousel=carousel={instances:{},time_change:5000,time_fade:300,init:function(id,banner){var self=this;banner=typeof banner=="boolean"?banner:false;if(banner==true){var show=banner&&((document.cookie.indexOf("rotativoDeChamadasNoBanner"+id+"=1")==-1)?true:false);if(typeof window.showBanner=="undefined"||window.showBanner===false){window.showBanner=show;}}if(!this.instances[id]){var $el=$("#"+id),$viewport=$el.find(".viewport"),$thumbs=$el.find(".thumbs li"),$items=$viewport.find("li");this.instances[id]={id:id,element:$el,viewport:$viewport,banner:banner,timecontrol:null,progresscontrol:null,thumbcontrol:null,progressbar:$el.find(".progress-bar .bar"),items:$items,total_items:$items.length,thumbs:$thumbs,bar_thumb:$el.find(".thumb-selected"),old_thumb:null,actual:0,ismouseover:false,showed:1,can_click:true,cont_imgs_load:$items.find("img").length,last_was_banner:false};var instance=this.instances[id];$thumbs.eq(0).addClass("actual");$thumbs.find("a").bind("click",function(ev){var li=(function(el){while(el&&el.nodeName!="LI"){el=el.parentNode;}return el;}(this));if(instance.can_click!=true||$(li).hasClass("actual")==false){ev.preventDefault();this.setAttribute("data-href",this.href);/^http:\/\/click\.uol/.test(this.href)==true&&this.setAttribute("href",this.href.split("&u=")[1]);window.disableRot&&disableRot();var a=this;setTimeout(function(){a.setAttribute("href",a.getAttribute("data-href"));},200);return false;}return true;});$el.bind("mouseover mouseout click",(function(){var time=null;return function(ev){if(instance.last_was_banner==true){return false;}var $item=jQuery(ev.srcElement||ev.target).closest(".thumbs .item");instance.ismouseover=ev.type=="mouseover";clearTimeout(time);time=setTimeout(function(){switch(ev.type){case"mouseover":case"click":self.pause(id);if($item.length&&$item.hasClass("actual")==false){if(instance.old==null){instance.old=instance.actual;}self.goTo(id,$thumbs.index($item),true);}break;case"mouseout":self.register(id);break;}},300);};}()));$items.find("img").each(function(){if(this.complete){Lib.carousel.imageLoaded(id);}else{$(this).one("load",Lib.carousel.imageLoaded(id));}});}},imageLoaded:function(id){var instance=this.instances[id];instance.cont_imgs_load--;if(instance.cont_imgs_load===0){this.register(id);}},pause:function(id){var instance=this.instances[id];actual=instance.actual,$thumbs=instance.thumbs;clearTimeout(instance.timecontrol);instance.timecontrol=null;this.setDefaultProgressThumb($thumbs.eq(actual).find(".progress"));instance.items.hide().eq(instance.actual).show().end().css("opacity",1);},register:function(id){var instance=this.instances[id],self=this;this.pause(id);this.startProgressThumb(id);instance.timecontrol=setTimeout(function(){carousel.next(id);},this.time_change);},startProgressThumb:function(id){var instance=this.instances[id],actual=instance.actual,$thumbs=instance.thumbs;$thumbs.eq(actual).find(".progress").animate({width:59},this.time_change,function(){carousel.setDefaultProgressThumb($(this));});},setDefaultProgressThumb:function(thumb){thumb.stop();thumb.css("width",0);},startProgressBar:function(id){var instance=this.instances[id],progresscontrol=instance.progresscontrol||[],$progress=instance.progressbar,$items=instance.items,loops=20,timeout_time=Math.round(this.time_change/loops),i=timeout_time,time=this.time_change;$progress.stop().css("width","0%");if(instance.ismouseover==false&&$items.filter(":visible").hasClass("banner")==false){var start_time=+new Date();var change_width=function(exec_time){var time_progress=(+new Date())-start_time,new_width=(100*time_progress/time);$progress.css("width",(new_width>100?100:new_width)+"%");if(time_progress<time){progresscontrol.push(_requestAnimationFrame(change_width));}};progresscontrol.push(_requestAnimationFrame(change_width));}instance.progresscontrol=progresscontrol;},restartProgressBar:function(id){this.stopProgressBar(id);this.startProgressBar(id);},stopProgressBar:function(id){var instance=this.instances[id],progresscontrol=instance.progresscontrol||[],i=progresscontrol.length,$progress=instance.progressbar;while(i--){clearTimeout(progresscontrol[i]);_cancelAnimationFrame(progresscontrol[i]);}$progress.css("width",0);return instance.progresscontrol=[];},next:function(id){var instance=this.instances[id],item=instance.actual+1;if(item>instance.total_items-1){item=0;}this.goTo(id,item,false);},prev:function(id){var instance=this.instances[id],item=instance.actual-1;if(item<0){item=instance.total_items-1;}this.goTo(id,item,false);},closeBanner:function(id){var instance=this.instances[id];document.cookie="rotativoDeChamadasNoBanner"+id+"=1; path=/";instance.banner=false;this.next(id);},goTo:function(id,n,preview){var instance=this.instances[id],$items=instance.items,actual=instance.actual,$viewport=instance.viewport,$thumbs=instance.thumbs;if(actual==n){return false;}if(instance.last_was_banner==true){instance.last_was_banner=false;$items.filter(".banner").remove();$items=instance.items=$viewport.find("li");n-=1;}if(instance.banner==true&&window.mostrabanner===1&&instance.showed==5&&preview==false){instance.showed=0;$items.eq(n).before('<li class="item banner" style="opacity:1;display:none;">					<a class="opacity-hover" href="'+mostrabannerLINK+'">						<img src="'+mostrabannerIMG+'" class="opacity-90">					</a>					<div class="header-banner">						<span class="cor9">Publicidade</span>						<em><a onclick="Lib.carousel.closeBanner(\''+id+'\')" class="corf opacity-hover-this">Fechar<i class="sprite-icones sprite-icones-fechar"></i></a></em>					</div>				</li>');instance.last_was_banner=true;$items=instance.items=$viewport.find("li");actual+=1;}this.pause(id);var $input=$items.eq(n),$output=$items.eq(actual);$thumbs.eq(actual).removeClass("actual").end();$thumbs.eq(n).addClass("actual");if(preview==false&&instance.last_was_banner==false){instance.showed+=1;}instance.actual=n;this.fade(id,$input,$output,preview,!instance.last_was_banner);},fade:function(id,$input,$output,preview,notIsBanner){var self=this,instance=this.instances[id],$thumb=instance.thumbs.eq(instance.actual),$bar_thumb=instance.bar_thumb,time_fade=preview==true?instance.time_fade:instance.time_fade/2;instance.can_click=false;$input.hide();$output.stop().fadeOut(self.time_fade,function(){$input.fadeIn(self.time_fade,function(){if(preview==false){self.register(id);}instance.can_click=true;});});if(notIsBanner==true){if($thumb.length){$bar_thumb.show();$bar_thumb.css("left",$thumb.get(0).offsetLeft);}}else{$bar_thumb.hide();}}};}(jQuery));