(function(){try{if(!window.opener||!window.location.search||!(window.opener.location&&window.opener.location.protocol&&window.opener.location.host&&window.opener.location.pathname&&window.opener.location.protocol+"//"+window.opener.location.host+window.opener.location.pathname===window.location.protocol+"//"+window.location.host+window.location.pathname)){return;}}catch(e){return;}console.debug("OY!");var reEval=/^(?:[0-9]+|true|false)$/i,obj={};location.search.replace(/(?:\?|&)([^=]+)=([^&]+)/g,function(str,attr,value){var childs=attr.split("."),childObj=obj;for(var i=0;i<childs.length-1;i++){childObj=childObj[childs[i]]=childObj[childs[i]]||{};}childObj[childs[childs.length-1]]=reEval.test(value)?eval(value.toLowerCase()):value;return str;});if(window.opener&&window.opener.socialCallback){window.opener.socialCallback.call(window.opener,obj);}window.close();})();(function(){var BrowserWindow=function(data){data=jQuery.extend({url:null,width:null,height:null,data:{}},data);var thisWindow,getUrl=function(data){var url=data.url;jQuery.each(data.data,function(name,value){url+="&"+encodeURIComponent(name)+"="+encodeURIComponent(value);});url=url.replace("&","?");return url;},init=function(data){var url=data.url?getUrl(data):"about:blank",options=data.width&&data.height?"width="+data.width+",height="+data.height+",scrolling=no,statusbar=no,resizeable=no":"";return thisWindow=window.open(url,"window_"+(new Date()).getTime(),options);};this.open=function(data){data=jQuery.extend({data:{}},data);return thisWindow.location.href=getUrl(data);};this.close=function(){return thisWindow.close();};this.get=function(){return thisWindow;};init.apply(this,arguments);return this;};jQuery.openWindow=function(data){return new BrowserWindow(data);};})();jQuery.ajaxFrame=function(data){data=jQuery.extend({data:{},dataType:"post",callback:jQuery.noop},data);var form,$form,name,frameName="ajax-frame-"+(new Date()).getTime(),$frame=jQuery('<iframe scrolling="no" frameborder="0" name="'+frameName+'"></iframe>');form='<form action="'+data.url+'" method="'+data.dataType+'" target="'+frameName+'">';for(name in data.data){if(data.data.hasOwnProperty(name)){form+='<input type="hidden" name="'+name+'" value="'+data.data[name]+'"/>';}}form+="</form>";$form=jQuery(form);$frame.hide().appendTo("body");$form.appendTo("body").hide();window.setTimeout(function(){$frame.load(function(){window.setTimeout(function(){$frame.remove();},500);$form.remove();data.callback.apply(this,arguments);});$form.submit();},500);};var configValidate={"200":{trigger:"babel:success"},"400":{trigger:"babel:invalid-parameter"},"422":{trigger:"babel:subject:invalid-size"},"431":{trigger:"babel:user:nickname"},"423":{trigger:"babel:subject:close"},"432":{trigger:"babel:user:anti-flood"},"436":{trigger:"babel:user:not-allowed"},"440":{trigger:"babel:session-expired"}};var _isBlockedAccess=document.getElementsByTagName("body")[0].getAttribute("data-blocked")=="true";jQuery.BabelCore=jQuery.BabelCore||{};jQuery.extend(jQuery.BabelCore,{init:function(args){args=jQuery.extend({portal:"uol"},args);this.Messages._subject=null;this.Messages._currentPage=null;this.Messages._refreshCache={};this.User._resultCached=null;this.User.Social._networksLoggedIn=null;this.portal=args.portal;},Messages:{_refreshCache:{},_subject:null,_currentPage:null,get:function(args){args=jQuery.extend({page:"first",size:10,all:false,replies:true,callback:jQuery.noop,portal:jQuery.BabelCore.portal},args);if(this._subject){args.subject=this._subject.result.id;}var parent=this;function retriveMessages(subject){if(subject.result.isClosed){jQuery(window).trigger("babel:subject:close-subject");}function _validaAba(){Config.Comentario=Config.Comentario||{Aba:{}};var _aba=Config.Comentario.Aba;_url="https://view.comentarios.uol.com.br/subject"+(args.all?"-all":"")+"/"+args.subject;if(typeof(_aba)!="undefined"&&_aba=="escolhaDoEditor"){_url="https://view.comentarios.uol.com.br/v1/messages/editor-recommended/"+args.subject;}else{if(typeof(_aba)=="undefined"&&subject.result.hasEditorRecommendation){_url="https://view.comentarios.uol.com.br/v1/messages/editor-recommended/"+args.subject;jQuery("#comentarios li").removeClass("selected border-color9 font-color1");jQuery("#comentarios li.escolhaDoEditor").addClass("selected border-color9 font-color1");}else{if(typeof(_aba)!="undefined"&&_aba=="maisCurtidos"){jQuery("#comentarios li").removeClass("selected border-color9 font-color1");jQuery("#comentarios li.maisCurtidos").addClass("selected border-color9 font-color1");args.sort="like:desc,created:desc";}else{if(typeof(_aba)=="undefined"&&subject.result.highestMessageLikes>=1){jQuery("#comentarios li").removeClass("selected border-color9 font-color1");jQuery("#comentarios li.maisCurtidos").addClass("selected border-color9 font-color1");args.sort="like:desc,created:desc";}else{if(typeof(_aba)!="undefined"&&_aba=="todos"){jQuery("#comentarios li").removeClass("selected border-color9 font-color1");jQuery("#comentarios li.todos").addClass("selected border-color9 font-color1");args.sort="";}else{jQuery("#comentarios li").removeClass("selected border-color9 font-color1");jQuery("#comentarios li.todos").addClass("selected border-color9 font-color1");args.sort="";}}}}}return _url;}var _urlToAjax=_validaAba();jQuery.ajax({url:_urlToAjax,cache:true,jsonpCallback:"BabelModelCommentsMessages",dataType:"jsonp",data:{repository:subject.result.repository,size:args.size,sort:args.sort,next:"next"===args.page&&parent._currentPage.next?parent._currentPage.next:undefined,prev:"previous"===args.page&&parent._currentPage.prev?parent._currentPage.prev:undefined,load_replies:args.replies},success:function(response){var _aba=Config.Comentario.Aba;if((typeof(_aba)!="undefined"&&_aba=="escolhaDoEditor")||(typeof(_aba)=="undefined"&&subject.result.hasEditorRecommendation)){var totalComments={"totalComments":response.docs.length};}else{var totalComments={"totalComments":subject.result.total};}jQuery.each(response.docs,function(index,message){message.social_network=message.social_network.replace("UOLK","UOL");});parent._currentPage=response;response=jQuery.extend(subject.result,response);response=jQuery.extend(totalComments,response);args.callback.call(this,response);if(response.docs.length){parent._refreshCache[args.subject]=response.docs[response.docs.length-1].id;}else{parent._refreshCache[args.subject]=0;}}});}if(!this._subject){jQuery.ajax({url:"https://view.comentarios.uol.com.br/ws/v1/subject/retrieve/"+args.subject+"?portal="+args.portal+((args.load_ratings)?"&load_ratings=true":""),cache:true,jsonpCallback:"BabelModelCommentsSubject",dataType:"jsonp",success:function(response){parent._subject=response;args.subject=response.result.id;retriveMessages(response);Config.Comentario.Recomendation=response.result.hasEditorRecommendation;}});}else{retriveMessages(this._subject);}},likeds:function(args){args=jQuery.extend({subject:this._subject?this._subject.result.id:null,callback:jQuery.noop},args);jQuery.ajax({url:"https://view.comentarios.uol.com.br/v1/likes-by-subject/"+args.subject,jsonpCallback:"BabelModelCommentsLikeds",cache:true,dataType:"jsonp",success:function(response){args.callback(response);}});},moreAnswers:function(args){jQuery.ajax({url:"https://view.comentarios.uol.com.br/v1/messages/parent/"+args.comment_id,cache:true,jsonpCallback:"BabelModelCommentsMoreAnswers",dataType:"jsonp",data:{repository:this._subject.result.repository,size:args.size,next:(args.page==="next"&&args.next)?args.next:undefined},success:function(response){args.callback(response);}});},refresh:function(args){var parent=this,originalCallback=args.callback;args.all=true;args.callback=function(response){var newDocs=[],isReproved;for(var i=0;i<response.docs.length;i++){isReproved="DISAPPROVED"===response.docs[i].moderation_status;notVisible="NOT_VISIBLE"===response.docs[i].message_status;if(response.docs[i].id>parent._refreshCache[args.subject]&&!isReproved&&!notVisible){newDocs.push(response.docs[i]);}else{if(response.docs[i].id<=parent._refreshCache[args.subject]&&isReproved){jQuery(window).trigger("babel:message:reproved",response.docs[i]);}}}response.docs=newDocs;return originalCallback.apply(this,arguments);};return this.get(args);},create:function(args){args=jQuery.extend({product:"noticias",callback:jQuery.noop},args);jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/v2/message/create",dataType:"jsonp",data:{message:args.message,rating:args.rating,parent:args.parent,subject:this._subject.result.id,product:args.product,social_networks:args.social_networks?args.social_networks.join(","):undefined,source:jQuery.BabelCore.User.getSource(),token:jQuery.BabelCore.User.getToken()},success:function(response){var created=new Date(),numberWithTwoDigits=function(number){return number.toString().length===1?"0"+number.toString():number;};if(configValidate[response.code]){jQuery(window).trigger(configValidate[response.code].trigger,response);}response.result.created=created.getFullYear().toString()+numberWithTwoDigits(created.getMonth()+1)+numberWithTwoDigits(created.getDate())+numberWithTwoDigits(created.getHours())+numberWithTwoDigits(created.getMinutes())+numberWithTwoDigits(created.getSeconds());response.result.social_network=jQuery.BabelCore.User.getSource()||"UOLK";args.callback.apply(this,arguments);}});},like:function(args){args=jQuery.extend({product:"noticias",repository:this._subject?this._subject.result.repository:null,callback:jQuery.noop},args);jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/v1/message/like/"+args.message,dataType:"jsonp",data:{repository:args.repository,product:args.product,source:jQuery.BabelCore.User.getSource(),token:jQuery.BabelCore.User.getToken()},success:args.callback});},remove:function(args){args=jQuery.extend({callback:jQuery.noop},args);jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/v1/message/delete/"+args.message,dataType:"jsonp",data:{repository:this._subject.result.repository,token:jQuery.BabelCore.User.getToken()},success:args.callback});}},CookieData:{_prefix:"babel-",get:function(attr){var result=document.cookie.match(new RegExp(this._prefix+attr+"=([^;]+)"));return result?result[1]:undefined;},set:function(attr,value){document.cookie=this._prefix+attr+"="+value.toString();}},User:{_resultCached:null,login:function(args){args=jQuery.extend({redirectOnError:true,callback:jQuery.noop},args);var parent=this;jQuery.ajaxFrame({url:"https://acesso.uol.com.br/login.html?skin=comentarios&dest=REDIR|//www3.uol.com.br/interacao/comentarios/blank.htm",data:{user:args.user,pass:args.pass},callback:function(){parent.get({callback:function(response){if(response.result.isLogged||!args.redirectOnError){args.callback.apply(this,arguments);}else{var isMobile=window.Config&&window.Config.Comentario&&window.Config.Comentario.platform&&window.Config.Comentario.platform==="mobile"?true:false;if(!isMobile){var skin=jQuery.BabelCore.portal!=="bol"?"comentarios":"bol",urlAction="https://acesso.uol.com.br/login.html?skin="+skin+"&dest=REDIR|"+location.href;jQuery('<form action="'+urlAction+'" target="_self" method="post">												<input type="hidden" name="user" value="'+args.user+'"/>												<input type="hidden" name="pass" value="'+args.pass+'"/>											</form>').appendTo("body").submit();}else{jQuery(".login-error").show();}if(_isBlockedAccess){window.countError({component:"porteira-login-internacional",description:"E-mail ou senha incorretos"});}}},"isUserLogin":true});}});},logout:function(args){args=jQuery.extend({callback:jQuery.noop},args);var parent=this;jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/v1/user/logout",dataType:"jsonp",success:function(){parent._resultCached=null;args.callback.apply(this,arguments);jQuery.BabelCore.User.logoutAcesso();jQuery(window).trigger("babel:logout");}});},logoutAcesso:function(){jQuery.ajaxFrame({url:"https://acesso.uol.com.br/logout.html?skin=comentarios&dest=REDIR|//www3.uol.com.br/interacao/comentarios/blank.htm",callback:function(response){if(!response.result){typeof(widgetProfile)==="object"&&widgetProfile.reloadWidget(function(){var index=window.universal_variable.sc&&window.universal_variable.sc.components&&window.universal_variable.sc.components.indexOf("widget-notificacoes-logado");if(index!=-1){window.universal_variable.sc.components.splice(index,1,"widget-notificacoes-deslogado");}});if(_isBlockedAccess){Lib.ReadMore.readMoreLogin(false);}}}});},get:function(args){args=jQuery.extend({triggerLogin:true,source:"UOL",product:"noticias",callback:jQuery.noop},args);var parent=this;var api_versao="v3";if(/MSIE [789]/.test(navigator.userAgent)===true||/Android (2.[0123]|2.\d+)/.test(navigator.userAgent)===true){api_versao="v2";}jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/"+api_versao+"/user/login",crossDomain:true,dataType:api_versao=="v2"?"jsonp":"json",xhrFields:{withCredentials:true},data:{auto_import:true,product:args.product,source:args.source},error:function(jqXHR,textStatus,errorThrown){if(_isBlockedAccess){window.countError({component:"porteira-login-internacional",description:"Erro no serviço de login. Status:  "+textStatus});}},success:function(response){parent._resultCached=response.result;if(response.result){if(response.result.isLogged){typeof(widgetProfile)==="object"&&widgetProfile.reloadWidget(function(){var index=window.universal_variable.sc&&window.universal_variable.sc.components&&window.universal_variable.sc.components.indexOf("widget-notificacoes-deslogado");if(index!=-1){window.universal_variable.sc.components.splice(index,1,"widget-notificacoes-logado");if(_isBlockedAccess){window.countPV&&window.countPV();}}});if(response.result.user){if(!response.result.user.codProfileHash){response.result.user.firstName=response.result.user.username.replace(/ .*$/,"");}if(1!=response.result.user.userStatus&&null!==response.result.user.codProfileHash){response.result.user.username="Visitante";}if(args.triggerLogin){response.result.isUserLogin=args.isUserLogin?args.isUserLogin:false;parent._triggerLogin(response.result);}}if(!response.result.user||5==response.result.user.userStatus){jQuery(window).trigger("babel:need-nickname");}if(!response.result.user||7==response.result.user.userStatus){jQuery(window).trigger("babel:need-nickname");}}}args.callback.apply(this,arguments);if(_isBlockedAccess){Lib.ReadMore.readMoreLogin(response.result);}}});},_triggerLogin:function(result){jQuery(window).trigger("babel:login",result).trigger("babel:login:"+result.user.socialNetwork.toLowerCase(),result);},username:function(args){args=jQuery.extend({product:"noticias",triggerDelay:0,callback:jQuery.noop},args);var parent=this;jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/v1/user/"+(!this.isLogged()?"create":"update"),dataType:"jsonp",data:{username:args.username,product:args.product,token:this.getToken()},success:function(responseLogin){if(responseLogin.result&&responseLogin.code=="200"&&!parent.isLogged()){parent.get({triggerLogin:false,callback:function(responseUser){parent.replyNotification({replyNotification:true});responseLogin.result.replyNotification=true;if(responseUser.result.user){responseUser.result.user.replyNotification=true;}window.setTimeout(function(){parent._triggerLogin(responseUser.result);},args.triggerDelay);args.callback(responseLogin);}});}else{args.callback(responseLogin);}}});},persist:function(args){args=jQuery.extend({social:true},args);var parent=this,logged=false;if(args.social){jQuery.BabelCore.User.Social._whereAmI({callback:function(response){jQuery.each(response.result||[],function(index,network){jQuery(window).trigger("babel:"+network.snname.toLowerCase()+":login",network);if(network.logged){parent.get({source:network.snname.toUpperCase()});logged=true;return false;}});if(!logged){parent.get();}}});}else{parent.get();}},ping:function(){jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/v1/user/ping",dataType:"jsonp",success:function(data){}});},persistLogin:function(args){this.persistBabel=setInterval(this.ping,600000);},removePersistLogin:function(){window.clearInterval(this.persistBabel);},replyNotification:function(args){args=jQuery.extend({product:"noticias",callback:jQuery.noop},args);jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/v1/user/update/reply-notification",dataType:"jsonp",data:{reply_notification:args.replyNotification,product:args.product,token:jQuery.BabelCore.User.getToken()},success:args.callback});},current:function(){return this._resultCached;},getToken:function(){return this.current()?this.current().token:undefined;},getSource:function(){return this.current()?this.current().user.socialNetwork:undefined;},isLogged:function(){return !!this.getToken();},has:function(){return this.isLogged()&&this.current().user!==null;},state:function(){var state="logged-out";if(this.current()&&this.current().isLogged){state="logged-in";if(!this.current().user||5==this.current().user.userStatus){state="need-username";}else{state="has-user";}}return state;},Avatar:{galleries:function(args){args=jQuery.extend({product:"noticias",callback:jQuery.noop},args);jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/v1/avatar/category/by-product/"+args.product,dataType:"jsonp",success:args.callback});},gallery:function(args){args=jQuery.extend({callback:jQuery.noop},args);jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/v1/avatar/image/by-category/"+args.gallery,dataType:"jsonp",success:args.callback});},save:function(args){args=jQuery.extend({product:"noticias",callback:jQuery.noop},args);jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/v1/user/update/image",dataType:"jsonp",data:{image_id:args.avatar,product:args.product,token:jQuery.BabelCore.User.getToken()},success:function(response){jQuery.BabelCore.User._resultCached=jQuery.extend(true,response.result,jQuery.BabelCore.User._resultCached);jQuery(window).trigger("babel:login",jQuery.BabelCore.User._resultCached);args.callback(response);}});}},Social:{_networksLoggedIn:null,Facebook:{_sn:1,_source:"FACEBOOK",login:function(args){args=jQuery.extend({bound:false,type:"login",callback:jQuery.noop},args);var parent=this,isBoundedLogin="login"===args.type&&args.bound;jQuery.BabelCore.User.Social._startSession({network:parent._sn,source:(isBoundedLogin?"UOL":"")+parent._source,type:isBoundedLogin?"login_social":args.type,callback:args.callback});},isLogged:function(){return jQuery.BabelCore.User.Social._isLoggedIn(this._sn);},select:function(selected){jQuery.BabelCore.User.Social._select(this._sn,selected);},isSelected:function(selected){return jQuery.BabelCore.User.Social._isSelected(this._sn);}},Twitter:{_sn:5,_source:"TWITTER",login:function(args){args=jQuery.extend({type:"login",callback:jQuery.noop},args);if("login"===args.type){}var parent=this;jQuery.BabelCore.User.Social._startSession({network:parent._sn,source:parent._source,type:args.type,callback:args.callback});},isLogged:function(){return jQuery.BabelCore.User.Social._isLoggedIn(this._sn);},select:function(selected){jQuery.BabelCore.User.Social._select(this._sn,selected);},isSelected:function(selected){return jQuery.BabelCore.User.Social._isSelected(this._sn);}},Orkut:{_sn:6,_source:"ORKUT",login:function(args){args=jQuery.extend({type:"login_social",callback:jQuery.noop},args);if("auth"!==args.type){throw new Error("Não é possível logar-se por uma conta do Orkut");}var parent=this;jQuery.BabelCore.User.Social._startSession({network:parent._sn,source:parent._source,type:args.type,callback:args.callback});},isLogged:function(){return jQuery.BabelCore.User.Social._isLoggedIn(this._sn);},select:function(selected){jQuery.BabelCore.User.Social._select(this._sn,selected);},isSelected:function(selected){return jQuery.BabelCore.User.Social._isSelected(this._sn);}},_select:function(sn,selected){var networks=(jQuery.BabelCore.CookieData.get("share")||"").split(","),isSelected=false;jQuery.each(networks,function(index,network){if(network==sn){if(!selected){networks.splice(index,1);}else{isSelected=true;}return false;}});if(!isSelected){if(selected){networks.push(sn);}jQuery.BabelCore.CookieData.set("share",networks.join(","));}},_isSelected:function(sn){var networks=(jQuery.BabelCore.CookieData.get("share")||"").split(","),isSelected=false;jQuery.each(networks,function(index,network){if(network==sn){isSelected=true;return false;}});return isSelected;},_startSession:function(args){args=jQuery.extend({callback:jQuery.noop},args);var parent=this,socialCallbackName="socialCallback",popup=jQuery.openWindow({width:(args.network==1?330:600),height:(args.network==1?180:600)}),uri=Config.Conteudo.media==="blog"?"?xtype=blog&subtype=enviado":"/_include/v1/web/servico/ajax.htm?subtype=enviado";jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/v1/user/social/start-session?portal="+jQuery.BabelCore.portal,dataType:"jsonp",data:{sn:args.network,social_auth_type:args.type,url_callback:location.protocol+"//"+location.hostname+uri},success:function(response){window[socialCallbackName]=function(response){var dispatchLogin=function(user){jQuery(window).trigger("babel:"+user.snname.toLowerCase()+":login",user);};if("auth"!==args.type&&response.success){jQuery.BabelCore.User.get({source:args.source,callback:function(response){dispatchLogin({sn:args.network,snname:args.source.toLowerCase(),uname:response.result.user.username,rawuname:response.result.user.username,logged:true,bounded:true});args.callback(response);}});}else{parent._whereAmI({network:args.network,callback:function(response){jQuery.each(response.result,function(index,user){dispatchLogin(user);});args.callback(response);}});}try{delete window[socialCallbackName];}catch(e){window[socialCallbackName]=null;}};popup.open({url:"https://social.api.uol.com.br/oauth",data:{"x-uol-social-tk":response.result.socialtoken,sn:args.network,"scope":"public_profile,email,user_birthday,publish_actions"}});}});},_isLoggedIn:function(sn){var ret=false;jQuery.each(jQuery.BabelCore.User.Social._networksLoggedIn||[],function(index,socialNetwork){if(sn==socialNetwork.sn){ret=true;return false;}});return ret;},_whereAmI:function(args){args=jQuery.extend({callback:jQuery.noop},args);jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/v1/user/social/where-am-i",dataType:"jsonp",success:function(response){jQuery.BabelCore.User.Social._networksLoggedIn=response.result;args.callback(response);}});}}},Subject:{like:function(args){args=jQuery.extend({anonymous:true,callback:jQuery.noop},args);function call(){jQuery.ajax({url:"https://n.comentarios.uol.com.br/ws/v1/subject/recommend/"+args.subject,dataType:"jsonp",data:{token:jQuery.BabelCore.User.getToken()},success:function(response){args.callback(response);}});}if(!args.anonymous||jQuery.BabelCore.User.getToken()){call();}else{jQuery.BabelCore.User.get({source:"ANONYMOUS",callback:function(){call();}});}}},Twitter:{_refreshCache:{},get:function(args){args=jQuery.extend({rpp:30,result_type:"recent",since_id:null,callback:jQuery.noop},args);var parent=this,data={q:args.q,rpp:args.rpp,result_type:args.result_type};if(args.since_id){data.since_id=args.since_id;}jQuery.ajax({url:"//search.twitter.com/search.json",dataType:"jsonp",data:data,success:function(response){parent._refreshCache[args.q]=response.max_id_str;args.callback.apply(this,arguments);}});},refresh:function(args){args.since_id=this._refreshCache[args.q];args.rpp=100;return this.get(args);}}});